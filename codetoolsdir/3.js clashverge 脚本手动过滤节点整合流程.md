# å½“ä½ æœ‰å…è´¹çš„èŠ‚ç‚¹ï¼Œå¤§éƒ¨åˆ†ä¸èƒ½ç”¨ä¸”å ç”¨å¤§é‡å†…å­˜æ—¶å°±éœ€è¦åœ¨æœ¬åœ°æ‰‹åŠ¨è¿‡æ»¤èŠ‚ç‚¹æ•´åˆ
## éœ€è¦ç”¨åˆ°
> [åœ¨çº¿èŠ‚ç‚¹è½¬æ¢å™¨](https://v2.v2rayse.com/node-convert)  
  [Clash Verge](https://github.com/Clash-Verge-rev/clash-verge-rev/releases)  

## é¦–å…ˆå°†è®¢é˜…é“¾æ¥(ä¸ç®¡æ˜¯ä¸æ˜¯ clash )éƒ½è½¬ä¸º v2ray åˆ—è¡¨ ç„¶åå†å°† v2ray è½¬ä¸º clash.meta
> è¿›å…¥ [åœ¨çº¿èŠ‚ç‚¹è½¬æ¢å™¨](https://v2.v2rayse.com/node-convert)  
  ç²˜è´´ è®¢é˜…é“¾æ¥ ï¼Œç‚¹å‡»ã€ŒåŠ è½½ã€å›¾æ ‡è¿›è¡ŒåŠ è½½ï¼ŒåŠ è½½å›¾æ ‡æ˜¯è“è‰²å°äº‘æœµ  
  ç„¶åå‹¾é€‰è½¬æ¢æ ¼å¼ä¸º V2ray ç‚¹å‡» [è½¬æ¢] å›¾æ ‡è¿›è¡Œè½¬æ¢ï¼Œå¯ä»¥å¾—åˆ°çº¯ V2ray èŠ‚ç‚¹ï¼Œç‚¹å‡»å¤åˆ¶  
  ç»§ç»­ç²˜è´´ V2ray èŠ‚ç‚¹ ï¼Œç‚¹å‡»ã€ŒåŠ è½½ã€å›¾æ ‡è¿›è¡ŒåŠ è½½ï¼ŒåŠ è½½å›¾æ ‡æ˜¯è“è‰²å°äº‘æœµ  
  ç„¶åå‹¾é€‰è½¬æ¢æ ¼å¼ä¸º Clash ç‚¹å‡» [è½¬æ¢] å›¾æ ‡è¿›è¡Œè½¬æ¢ï¼Œå¯ä»¥å¾—åˆ° Clash.meta èŠ‚ç‚¹é…ç½®æ–‡ä»¶ï¼Œç‚¹å‡»ä¸‹è½½  

## ç„¶åå¯¼å…¥èŠ‚ç‚¹æ–‡ä»¶å¹¶æµ‹é€Ÿ
> ç„¶åå¯¼å…¥ Clash.meta èŠ‚ç‚¹é…ç½®æ–‡ä»¶åˆ° Clash Verge  
  ç‚¹å‡» Clash Verge -> è®¾ç½® -> WEB UI æ‰“å¼€æµè§ˆå™¨ç½‘é¡µæ§åˆ¶ç«¯  
  ç‚¹å‡» ä»£ç† ï¼Œé€‰æ‹©ä¸€ä¸ªå±•ç¤ºæ‰€æœ‰èŠ‚ç‚¹çš„èŠ‚ç‚¹ç»„(æ¯”å¦‚åå­—æ˜¯ ğŸš€ æ‰‹åŠ¨åˆ‡æ¢ )  
  ç‚¹å‡» [å±•å¼€] å›¾æ ‡æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ï¼Œç‚¹å‡» [æµ‹é€Ÿ] å›¾æ ‡ï¼Œå¼€å§‹æµ‹é€Ÿ  

## æµ‹é€Ÿåå¼€å§‹è¿‡æ»¤
> ç‚¹å‡» Clash Verge -> è®¢é˜…ï¼Œåœ¨å¯ç”¨çš„è®¢é˜…ä¸Šå…‰æ ‡å³é”®ç‚¹å‡» ç¼–è¾‘æ–‡ä»¶  
  å¤åˆ¶ proxies: ä¸‹é¢çš„å…¨éƒ¨èŠ‚ç‚¹ï¼Œç²˜è´´åˆ°ä»¥ä¸‹jsè„šæœ¬çš„ const text = ``; å†…(å¦‚ä¸‹è„šæœ¬æ‰€ç¤º)  
  å›åˆ° WEB UI æµè§ˆå™¨ç½‘é¡µæ§åˆ¶ç«¯ï¼Œæ‰“å¼€ æµè§ˆå™¨å¼€å‘è€…å·¥å…· -> æ§åˆ¶å° æ‰§è¡Œä»¥ä¸‹jsè„šæœ¬(å…ƒç´ æœ‰å¯èƒ½éšç€å¼€å‘è€…æ›´æ–°å‘ç”Ÿå·¨å¤§æ”¹å˜ï¼Œè¯·éšæœºåº”å˜)  

```
// ä» Clash verge çš„ yacd æ§åˆ¶UI è·å–æ‰€æœ‰åŒ…å«æ ·å¼ class="_proxy_xgbmr_4 _selectable_xgbmr_32" çš„å…ƒç´ 
const elements = document.querySelectorAll('div._proxy_xgbmr_4._selectable_xgbmr_32');

// åˆ›å»ºä¸€ä¸ªæ•°ç»„æ¥å­˜å‚¨ç¬¦åˆæ¡ä»¶çš„ç»“æœ
let results = [];

// éå†è¿™äº›å…ƒç´ 
elements.forEach(element => {
    // æŸ¥æ‰¾è¯¥ div ä¸­å¸¦æœ‰æ¯«ç§’æ•°çš„ <span> å…ƒç´ 
    const latencyElement = element.querySelector('span._proxyLatency_1h5y2_4 span');
    
    // å¦‚æœæ‰¾åˆ°äº†è¯¥å…ƒç´ ï¼Œæå–å…¶æ–‡æœ¬
    if (latencyElement && latencyElement.innerText.includes('ms')) {
        // æŸ¥æ‰¾åŒä¸€ div ä¸­çš„ä»£ç†åç§° <span> å…ƒç´ 
        const proxyNameElement = element.querySelector('span[data-state="tooltip-hidden"][data-reach-tooltip-trigger]');
        
        if (proxyNameElement) {
            const proxyName = proxyNameElement.innerText;
            // åº”å¯¹ä¸åŒçš„ clash proxies å‰ç«¯åŒ¹é…
            results.push("  - {\"name\":\""+proxyName+"\",");
            // results.push("  - {name: \""+proxyName+"\",");
            // results.push("  - {name: "+proxyName+",");
            // åº”å¯¹ä¸åŒçš„ clash proxies æ¨¡ç³ŠåŒ¹é…ï¼Œå®¹æ˜“åŒ¹é…å¤šä¸ªå®¹é”™æ€§å¾ˆé«˜
            // results.push(proxyName);
        }
    }
});

// å°†ç»“æœæŒ‰è¡Œæ‹¼æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²
const resultString = results.join('\n');

// æ‰“å°æœ€ç»ˆç»“æœ
console.log(resultString);

// javascript è¿‡æ»¤å¤šè¡Œå­—ç¬¦ä¸²
// é€‚ç”¨äºæ‰‹å¤´æ²¡ä»£ç ç¯å¢ƒå¯ä»¥ä½¿ç”¨æµè§ˆå™¨çš„ å¼€å‘äººå‘˜å·¥å…·->æ§åˆ¶å° æ‰§è¡Œä¸€äº›å­—ç¬¦ä¸²æ“ä½œ
// ç‰¹å®šå­—ç¬¦ä¸²åˆ—è¡¨
const keywords = results;

// æºå­—ç¬¦ä¸²åˆ—è¡¨å¯è‡ªå®šä¹‰
const text = `
  - {"name":"ğŸ‡­ğŸ‡° VM-WS-NA ğŸ‡­ğŸ‡° HK-103.192.179.1833678","type":"vmess","server":"103.192.179.18","port":33678,"cipher":"auto","uuid":"3056f62f-5fac-4767-a9b8-63abc970684d","alterId":0,"tls":false,"skip-cert-verify":true,"network":"ws","ws-opts":{"path":"/"}}
  - {name: "EC(AzadNet.t.me)_001","type":"ss","server":"179.49.5.114","port":989,"password":"f8f7aCzcPKbsF8p3","cipher":"aes-256-cfb"}
  - {name: ğŸ‡¨ğŸ‡³ CN(AzadNet.t.me)_004,"type":"trojan","server":"154.197.121.127","port":443,"udp":true,"password":"moist","sni":"trojan.freenods.sbs","skip-cert-verify":true,"network":"ws","ws-opts":{"path":"/"}}
`;

// å‡½æ•°ï¼šæ ¹æ®æ¨¡å¼ç­›é€‰åŒ…å«ç‰¹å®šå­—ç¬¦ä¸²çš„è¡Œ
function filterLinesByMode(text, keywords, mode) {
  switch (mode) {
    case 1: // ç²¾ç¡®åŒ¹é…å‰ç«¯
      return text.split('\n').filter(line => 
        keywords.some(keyword => line.startsWith(keyword))
      );
    case 2: // ç²¾ç¡®åŒ¹é…ç»“å°¾
      return text.split('\n').filter(line => 
        keywords.some(keyword => line.endsWith(keyword))
      );
    case 3: // æ¨¡ç³ŠåŒ¹é…
      return text.split('\n').filter(line => 
        keywords.some(keyword => line.includes(keyword))
      );
    default:
      return [];
  }
}

// ç¤ºä¾‹ï¼šç”¨æˆ·é€‰æ‹©åŒ¹é…æ¨¡å¼
const mode = 1; // ä¿®æ”¹æ­¤å€¼ä»¥é€‰æ‹©ä¸åŒæ¨¡å¼ï¼š1 å‰ç«¯åŒ¹é…ï¼Œ2 ç»“å°¾åŒ¹é…ï¼Œ3 æ¨¡ç³ŠåŒ¹é…

// ç­›é€‰ç»“æœ
const filteredLines = filterLinesByMode(text, keywords, mode);

// å°†ç»“æœæ‹¼æ¥ä¸ºå¤šè¡Œå­—ç¬¦ä¸²
const result = filteredLines.join('\n');

// è¾“å‡ºç»“æœ
console.log("proxies:\n"+result);
```
  
## å°† èŠ‚ç‚¹å†…å®¹ éƒ½è½¬ä¸º v2ray åˆ—è¡¨ ç„¶åå†å°† v2ray è½¬ä¸º clash.meta
> ä»¥ä¸Šè„šæœ¬ä¼šè¿”å›è¿‡æ»¤å‡ºæ¥çš„ èŠ‚ç‚¹å†…å®¹ ï¼Œå¤åˆ¶è¿‡æ»¤è¿”å›çš„ èŠ‚ç‚¹å†…å®¹
  è¿›å…¥ [åœ¨çº¿èŠ‚ç‚¹è½¬æ¢å™¨](https://v2.v2rayse.com/node-convert)  
  ç²˜è´´ èŠ‚ç‚¹å†…å®¹  
  ç„¶åå‹¾é€‰è½¬æ¢æ ¼å¼ä¸º Clash ç‚¹å‡» [è½¬æ¢] å›¾æ ‡è¿›è¡Œè½¬æ¢ï¼Œå¯ä»¥å¾—åˆ° Clash.meta èŠ‚ç‚¹é…ç½®æ–‡ä»¶ï¼Œç‚¹å‡»ä¸‹è½½  
  ç„¶åå¯¼å…¥ Clash.meta èŠ‚ç‚¹é…ç½®æ–‡ä»¶åˆ° Clash Verge å³å¯  

## å…¶ä»–
> å¯ä»¥éšæ—¶ç¼–è¾‘æ·»åŠ  Clash.meta èŠ‚ç‚¹é…ç½®æ–‡ä»¶çš„é…ç½®ï¼Œå¦‚ä¸‹  
``` 
port: 7891
socks-port: 7892
mixed-port: 7893
external-controller: :7894
redir-port: 7895
tproxy-port: 7896
allow-lan: true
mode: rule
log-level: debug
```
> ä¹Ÿå¯ä»¥å¯¼å…¥ Clash.meta èŠ‚ç‚¹é…ç½®æ–‡ä»¶åˆ° openclash ç›´æ¥ä½¿ç”¨